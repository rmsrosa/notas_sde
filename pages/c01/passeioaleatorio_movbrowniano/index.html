<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="" />
  <meta name="author" content="and contributors" />
   <title>Do passeio aleatório ao movimento Browniano</title>  
  <link rel="shortcut icon" type="image/png" href="/notas_sde/assets/images/favicon_randgon.png"/>
  <link rel="stylesheet" href="/notas_sde/css/base.css"/>
  
  <script src="/notas_sde/libs/mousetrap/mousetrap.min.js"></script>

  
    <link rel="stylesheet" href="/notas_sde/libs/highlight/github.min.css">
    <script src="/notas_sde/libs/highlight/highlight.pack.js"></script>
    <script src="/notas_sde/libs/highlight/julia.min.js"></script>
    <script>
      document.addEventListener('DOMContentLoaded', (event) => {
        document.querySelectorAll('pre').forEach((el) => {
          hljs.highlightElement(el);
        });
      });
    </script>
  

  
    <link rel="stylesheet" href="/notas_sde/libs/katex/katex.min.css">
  
</head>

<body>

  <div class="books-container">

  <aside class="books-menu">
  <input type="checkbox" id="menu">
  <label for="menu">☰</label>

  <div class="books-title">
    <a href="/notas_sde/">Equações Diferenciais Estocásticas e Aleatórias</a>
  </div>

  <br />

  <div class="books-subtitle">
    Aspectos Teóricos e Numéricos
  </div>

  <br />

  <div class="books-author">
    <a href="https://rmsrosa.github.io">Ricardo M. S. Rosa</a>
  </div>

  <div class="books-menu-content">
    <div class="menu-level-1">
    <li>1. Introdução</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c01/apresentacao">1.1. Apresentação</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c01/aspectos_iniciais">1.2. Equações diferenciais aleatórias e estocásticas</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c01/movimento_browniano">1.3. Movimento Browniano</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c01/modelo_einstein">1.4. O modelo de Einstein para o movimento Browniano</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c01/passeioaleatorio_movbrowniano">1.5. Do passeio aleatório ao movimento Browniano</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c01/modelo_bachelier">1.6. O modelo de Bachelier para o mercado de opções</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c01/aspectos_numericos">1.7. Aspectos numéricos</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c01/simulacoes_intro">1.8. Simulações numéricas de modelos de crescimento natural</a></li>
    </div>
    <div class="menu-level-1">
    <li>2. Variáveis Aleatórias</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c02/definicao_va">2.1. Conceitos essenciais</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c02/exemplos_va_discretas">2.2. Variáveis aleatórias discretas</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c02/exemplos_va_continuas">2.3. Variáveis aleatórias contínuas</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c02/media_momentos">2.4. Média, variância e outros momentos</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c02/prob_condicionada">2.5. Probabilidade condicionada</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c02/desigualdades">2.6. Desigualdades fundamentais</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c02/multi_va">2.7. Variáveis aleatórias multivariadas</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c02/transformacoes">2.8. Transformações de variáveis aleatórias</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c02/convergencias">2.9. Tipos de convergências</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c02/borel_cantelli">2.10. Lema de Borel-Cantelli</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c02/teorema_central">2.11. Teorema Central do Limite</a></li>
    </div>
    <div class="menu-level-1">
    <li>3. O método de Monte-Carlo</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c03/monte_carlo">3.1. O método de Monte-Carlo no estudo de variáveis aleatórias</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c03/histograma">3.2. Histograma - estimando a distribuição de probabilidades</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c03/gerando_num_aleatorios">3.3. Gerando números aleatórios no computador</a></li>
    </div>
    <div class="menu-level-1">
    <li>4. Processos Estocásticos</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c04/definicao_pe">4.1. Conceitos essenciais</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c04/processos_discretos">4.2. Processos em tempos discretos</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c04/processos_continuos">4.3. Processos em tempos contínuos</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c04/tipos_processos">4.4. Classes de processos</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c04/filtracao">4.5. Filtração</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c04/cadeias_markov">4.6. Processos de Markov</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c04/continuity_kolmogorov">4.7. Teorema de Continuidade de Kolmogorov</a></li>
    </div>
    <div class="menu-level-1">
    <li>5. Processos de Wiener</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c05/definicao_processo_wiener">5.1. Definição</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c05/existencia_processo_wiener">5.2. Existência de processos de Wiener</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c05/propriedades_wiener">5.3. Propriedades de processos de Wiener</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c05/ruido_branco">5.4. Relação com ruído branco</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c05/simetrias_wiener">5.5. Simetrias de processos de Wiener</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c05/naodiferenciabilidade_wiener">5.6. Não diferenciabilidade quase sempre dos caminhos amostrais</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c05/variacao_ilimitada_wiener">5.7. Variação ilimitada dos caminhos amostrais</a></li>
    </div>
    <div class="menu-level-1">
    <li><a href="/notas_sde/pages/c06/integracao_estocastica">6. Integração estocástica</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c06/integral_riemann">6.1. Integrais de Riemann</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c06/integral_riemannstieltjes">6.2. Integrais de Riemann-Stieltjes</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c06/integral_dualidade">6.3. Integrais via dualidade</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c06/riemann_wiener">6.4. Limites de somatórios à la Riemann-Stieltjes</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c06/integral_ito">6.5. Integral de Itô via processos uniformemente contínuos em média quadrática</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c06/integral_ito_l2">6.6. Integral de Itô via processos do tipo escada</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c06/integral_ito_propriedades">6.7. Propriedades da integral de Itô</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c06/formula_ito">6.8. Fórmula de Itô</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c06/integral_stratonovich">6.9. Integral de Stratonovich</a></li>
    </div>
    <div class="menu-level-1">
    <li>7. Equações diferenciais aleatórias</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c07/existence_solutions_rde">7.1. Existência e unicidade de soluções</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c07/basic_examples_rde">7.2. Exemplos básicos</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c07/logistic_rde">7.3. Equação logística aleatória</a></li>
    </div>
    <div class="menu-level-1">
    <li>8. Equações diferenciais estocásticas</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c08/setting">8.1. Interpretação da equação</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c08/existence_solutions_sde_particulares">8.2. Existência de soluções locais em casos particulares</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c08/existence_solutions_sde">8.3. Existência de soluções globais</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c08/unicidade_sol_sde">8.4. Unicidade de soluções</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c08/continuidade_caminhos">8.5. Limitação e continuidade das soluções</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c08/linear_sde">8.6. Resolução de equações lineares</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c08/geometric_brownian">8.7. Movimento Browniano geométrico e o preço de ações</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c08/brownian_bridge">8.8. Ponte Browniana</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c08/ornstein_uhlenbeck">8.9. A equação de Langevin e o processo de Ornstein-Uhlenbeck</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c08/ou_aproxima_ruidobranco">8.10. O processo de Ornstein-Uhlenbeck como aproximação de um ruído branco</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c08/asymptotic_stability">8.11. Estabilidade assintótica</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c08/relacoes_rode_sde">8.12. Relações entre equações estocásticas e equações aleatórias</a></li>
    </div>
    <div class="menu-level-1">
    <li>9. Evolução da função densidade de probabilidade</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c09/deterministic">9.1. Equação do transporte para equações diferenciais ordinárias</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c09/stochastic">9.2. Equação de Fokker-Planck para equações diferenciais estocásticas</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c09/stationaryOU">9.3. Distribuição assintótica estacionária dos processos de Ornstein-Uhlenbeck</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c09/feynmann_kac">9.4. Fórmula de Feynman-Kac e a equação retrógrada de Kolmogorov</a></li>
    </div>
    <div class="menu-level-1">
    <li>10. Métodos numéricos</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c10/tx_convergencia">10.1. Convergências forte e fraca</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c10/simulacoes_wiener">10.2. Simulações de processos de Wiener e browniano geométrico</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c10/convergencia_euler_maruyama">10.3. Convergência forte do método de Euler-Maruyama</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c10/nao_convergencia_euler_maruyama">10.4. Não convergência do método de Euler-Maruyama sem condição Lipschitz global</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c10/simulacoes_convergencia_em">10.5. Simulações ilustrando ordem de  convergência do método de Euler-Maruyama</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c10/heun">10.6. Método de Heun</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c10/simulacoes_convergencia_randomheun">10.7. Simulações ilustrando ordem de convergência do método de Heun para equações diferenciais aleatórias</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c10/milstein">10.8. O método de Milstein</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c10/simulacoes_milstein">10.9. Simulações Milstein</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c10/convergencia_fraca_em">10.10. Convergência fraca do método de Euler-Maruyama</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c10/sciml">10.11. O ambiente SciML da linguagem Julia</a></li>
    </div>
    <div class="menu-level-1">
    <li>11. Sistemas de equações aleatórias</li>
    </div>
    <div class="menu-level-1">
    <li>12. Sistemas de equações estocásticas</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c11/nuclear_reactions">12.1. Reações nucleares</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c11/stochastic_sir">12.2. Modelo SIR estocástico</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c11/stochastic_sir_network">12.3. Modelo SIR estocástico estruturado em rede</a></li>
    </div>
    <div class="menu-level-1">
    <li>Apêndice</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/appendix/teo_fund_kolmogorov">Teorema Fundamental de Kolmogorov</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/appendix/teo_extension_kolmogorov">Teorema de Extensão de Kolmogorov</a></li>
    </div>
    <div class="menu-level-1">
    <li><a href="/notas_sde/pages/references">References</a></li>
    </div>
<div>


  
    <a href="https://github.com/rmsrosa/notas_sde"><img src="/notas_sde/assets/images/GitHub-Mark-32px.png" alt="GitHub repo" width="18" style="margin:5px 5px" align="left"></a>

  

</aside>


  <div class="books-content">

    
      <div class="navbar">
    <p id="nav">
<span id="nav-prev" style="float: left;">
<a class="menu-level-1" href="/notas_sde/pages/c01/modelo_einstein">1.4. O modelo de Einstein para o movimento Browniano <kbd>←</kbd></a>
</span>
<span id="nav-next" style="float: right;">
    <a class="menu-level-1" href="/notas_sde/pages/c01/modelo_bachelier"><kbd>→</kbd> 1.6. O modelo de Bachelier para o mercado de opções</a>
</span>
    </p>
</div>
</br></br>

    

    
      
    
<h1 id="get_title"><a href="#get_title" class="header-anchor">1.5. Do passeio aleatório ao movimento Browniano</a></h1>
<p>Uma outra maneira de modelar o movimento Browniano é através de um processo conhecido como <em>passeio aleatório</em>, no caso em que consideramos escalas de tempo e de comprimento para os passos temporais e espaciais e quando tomamos os limites quando essas escalas vão para zero de forma apropriada. Louis Bachelier, cinco anos antes do ano miraculoso de Einstein, utilizou um processo que é essencialmente um passeio aleatório, em sua tese <a href="https://doi.org/10.24033/asens.476">L. Bachelier, Théorie de la spéculation, Annales scientifiques de l&#39;École Normale Supérieure, Serie 3, Volume 17 &#40;1900&#41;, pp. 21-86</a>, para justificar a forma da densidade de probabilidades de ações no mercado financeiro.</p>
<p>Vamos pensar em um passeio aleatório unidimensional, em um conjunto discreto \(\ell \mathbb{Z},\) onde \(\ell > 0\) é uma escala de comprimento. Usamos, também, uma escala de tempo \(\tau > 0.\) Assumimos que, a cada passo de tempo \(\tau,\) uma partícula pode se movimentar de uma distância exatamente \(\ell,\) para a direita ou para a esquerda, com probabilidade \(1/2\) em cada sentido. A motivação é que, a cada passo de tempo, a partícula será bombardeada mais de um lado do que de outro, de maneira aleatória e independente. É uma situação bastante idealizada, porque não leva em consideração possíveis variações relativas nas quantidades de bombardeamentos e no tamanho do passo, nem do momento adquirido pela partícula.</p>
<p>Denotamos, então, por \(p_n(m)\) a probabilidade da partícula estar na posição \(x = m\ell,\) no instante \(t = n\tau.\) Naturalmente, \(0 \leq p_n(m) \leq 1,\) com \(\sum_{m\in \mathbb{Z}} p_n(m) = 1,\) para todo \(n = 0, 1, \ldots.\)</p>
<p>Inicialmente, em \(t = 0,\) consideramos que a partícula está na <em>origem</em>, de modo que \(p_0(0) = 1\) e \(p_0(m) = 0,\) para \(m\ne 0.\) Vamos escrever isso, simetricamente, na forma</p>
\[
p_0 = (\ldots, 0, 0, 1, 0, 0, \ldots).
\]
<p>Após o primeiro passo, temos \(p_1(\pm 1) = 1/2\) e o \(p_1(m) = 0\) para \(m \neq \pm 1.\) Ou seja,</p>
\[
p_1 = (\ldots, 0, 1/2, 0, 1/2, 0, \ldots).
\]
<p>No instante seguinte,</p>
\[
p_2 = \left(\ldots, 0, \frac{1}{4}, 0, \frac{1}{2}, 0, \frac{1}{4}, 0, \ldots \right),
\]
<p>e assim por diante:</p>
\[
p_3 = \left(\ldots, 0, \frac{1}{8}, 0, \frac{3}{8}, 0, \frac{3}{8}, 0, \frac{1}{8}, 0, \ldots\right),
\]
\[
p_4 = \left(\ldots, 0, \frac{1}{16}, 0, \frac{5}{16}, 0, \frac{3}{16}, 0, \frac{5}{16}, 0, \frac{1}{16}, 0, \ldots\right),
\]
\[
\vdots
\]

<img src="/notas_sde/assets/pages/c01/passeioaleatorio_movbrowniano/code/output/randomwalkdistrib.gif" alt="">
<p>Podemos continuar e buscar um padrão para a sequência, mas podemos deduzir os valores de uma forma mais simples.</p>
<p>Para uma partícula chegar na posição \(x = \ell m,\) ela deve dar \(i\) passos para a direita e \(j\) passos para a esquerda, com \(i - j = m.\) Para isso acontecer no passo \(n,\) devemos ter \(i + j = n.\) Logo, devemos ter \(i = (n + m)/2\) passos para a direita e \(j = (n - m)/2\) passos para a esquerda. Cada passo ocorre com probabilidade \(1/2.\) Assim, após \(n\) passos, cada caminho ocorre com probabilidade \(1/2^n.\) Resta saber quantos caminhos existem até um determinado ponto \(x = \ell m.\)</p>
<p>Naturalmente, não há caminho caso \(m < -n\) ou \(m > n.\) E há apenas um caminho para \(m = -n\) e \(m = n.\) Mas pode haver vários caminhos ligando a outros pontos. Ou nenhum. De fato, se \(n\) e \(m\) tiverem paridades diferentes, então \(n + m\) é ímpar e não tem como darmos \(i = (n + m)/2\) passos para a direita, nem \(j = (n - m)/2\) para a esquerda. Resta, agora, saber o número de caminhos possíveis quando \(n\) e \(m\) têm a mesma paridade e \(|m| < n.\)</p>
<p>Para ver isso, vamos focar no fato de que, para chegarmos em \(x = m\ell\) após \(n\) passos, devemos dar \((n + m)/2\) passos para a direita. Se, por exemplo, \(n = 6\) e \(m = 2,\) devemos dar \((n + m)/2 = 4\) passos para a direita, mas eles podem acontecer em quaisquer quatro dos seis momentos entre \(\tau\) e \(n\tau.\) Isso nos dá \(\left(\begin{matrix} n \\ (n + m)/2 \end{matrix}\right) = \left(\begin{matrix} 6 \\ 4 \end{matrix}\right) = 15\) possibilidades de caminhos, de um total de \(2^6.\) Ou seja, \(p_6(2) = 15 / 64.\) Mais geralmente, temos</p>
\[
p_n(m) = \frac{1}{2^n}\frac{n!}{\left(\frac{n + m}{2}\right)!\left(\frac{n-m}{2}\right)!}.
\]
<p>Podemos reconhecer isso como a distribuição binomial</p>
\[
p_n(m) = \left(\begin{matrix} n \\ k \end{matrix}\right) p^k (1-p)^{n-k}, \qquad k = k(n, m) = \frac{n + m}{2}, \quad p = \frac{1}{2},
\]
<p>nos dando a probabilidade de \((n+m)/2\) sucessos em \(n\) sorteios de Bernoulli, com probabilidade \(p = 1 - p = 1/2\) de cada realização, com as realizações sendo os passos \(\ell\) e \(-\ell.\)</p>
<p>Denotando por \(X_n\) a posição da partícula no passo \(n \in \mathbb{Z}^* = \{0, 1, 2, \ldots\},\) temos que \(\{X_n\}_{n \in \mathbb{N}}\) é um processo estocástico discreto, com cada passo \(\Delta X = X_{n + 1} - X_n \sim \mathrm{Bernoulli}(\pm \ell, 1/2),\) representando o teste de Bernoulli com valores possíveis \(\pm \ell.\) Temos, ainda, que cada \(X_n\) é uma distribuição binomial com possíveis valores \(-n\ell, \ldots, n\ell,\) que podemos denotar por</p>
\[
X_n \sim B(\{-n\ell, \ldots, n\ell\}, 1/2),
\]
<p>com \(X_0 = 0\) quase sempre, ou seja,</p>
\[
X_0 \sim \delta_0.
\]
<h2 id="limite_contínuo"><a href="#limite_contínuo" class="header-anchor">Limite contínuo</a></h2>
<p>Assintoticamente, temos, pela fórmula de Stirling, que \(k! \simeq \sqrt{2\pi k} (k / e)^k,\) quando \(k \rightarrow \infty.\) Mais precisamente, vale a desigualdade</p>
\[
\sqrt{2\pi k} \left( \frac{k}{e} \right)^k e^{\frac{1}{12k+1}} < k! < \sqrt{2\pi k} \left( \frac{k}{e} \right)^k e^{\frac{1}{12k}}, \quad \forall k\in\mathbb{N}.
\]
<p>Por exemplo, para \(k = 8,\) temos \(e^{1/12k} \approx 1.01047,\) de modo que o erro relativo já é da ordem de 1&#37;, diminuindo rapidamente conforme \(k\) aumenta.</p>
<p>A ideia, então, é tomar o limite quando \(n \rightarrow \infty.\) Por sua vez, \(m\) pode ou não ir para infinito também, mas vamos manter sempre \(|m \ll n.\) Isso porque, assumindo, \(n \gg 1\) e \(|m| \ll n,\) temos também</p>
\[
    n \pm m \gg 1.
\]
<p>Com isso,</p>
\[
p_n(m) \simeq \frac{1}{2^n}\frac{\sqrt{2\pi n} (n / e)^n}{\sqrt{\pi (n + m)} ((n + m) / 2e)^{(n + m)/2}\sqrt{\pi (n - m)} ((n - m) / 2e)^{(n - m)/2}}.
\]
<p>Lembrando que isso é quando \(n + m\) é par, caso contrário \(p_n(m) = 0.\) Simplificando, obtemos</p>
\[
p_n(m) \simeq \sqrt{\frac{2n}{\pi(n^2 - m^2)}}\frac{n^n}{(n + m)^{(n + m)/2}(n - m)^{(n - m)/2}}.
\]
<p>Decompondo a potência do numerador em \(n^n = n^{(n+m)/2}n^{(n-m)/2},\) obtemos</p>
\[
p_n(m) \simeq \sqrt{\frac{2n}{\pi(n^2 - m^2)}}\left(\frac{n}{n+m}\right)^{(n + m)/2}\left(\frac{n}{n-m}\right)^{(n - m)/2}.
\]
<p>Invertendo a fração, temos</p>
\[
p_n(m) \simeq \sqrt{\frac{2n}{\pi(n^2 - m^2)}}\left(\frac{n+m}{n}\right)^{-(n + m)/2}\left(\frac{n-m}{n}\right)^{-(n - m)/2}.
\]
<p>Observe que</p>
\[ \left(\frac{n+m}{n}\right)^{-(n + m)/2}\left(\frac{n-m}{n}\right) = e^{\displaystyle -\frac{n + m}{2}\ln\left(1 + \frac{m}{n}\right) - \frac{n - m}{2}\ln\left(1 - \frac{m}{n}\right)}.
\]
<p>Sendo \(|m| \ll n,\) obtemos, pela expansão \(\ln(1 + x) = 0 + x - x^2/2 + \mathcal{O}(x^3) \approx x - x^2/2,\)</p>
\[ \left(\frac{n+m}{n}\right)^{-(n + m)/2}\left(\frac{n-m}{n}\right) \approx e^{\displaystyle -\frac{n + m}{2}\left(\frac{m}{n} + \frac{1}{2}\frac{m^2}{n^2}\right) - \frac{n - m}{2}\left(-\frac{m}{n} + \frac{1}{2}\frac{m^2}{n^2}\right)} = e^{\displaystyle -\frac{m^2}{2n}}.
\]
<p>Portanto,</p>
\[
p_n(m) \simeq \sqrt{\frac{2n}{\pi(n^2 - m^2)}} e^{\displaystyle -\frac{m^2}{2n}}.
\]
<p>Por outro lado, usando novamente que \(n \gg |m|,\) temos \(|m|/n \ll 1,\) de modo que</p>
\[
n^2 - m^2 = n^2\left(1 - \frac{m^2}{n^2}\right) \approx n^2.
\]
<p>Logo,</p>
\[
\sqrt{\frac{2n}{\pi(n^2 - m^2)}} \approx \sqrt{\frac{2}{\pi n}}.
\]
<p>Portanto, para \(n \gg 1\) e \(|m| \ll n,\) com \(n+m\) par, obtemos</p>
\[
p_n(m) \approx \sqrt{\frac{2}{\pi n}}e^{\displaystyle -\frac{m^2}{2n}}.
\]
<p>Passando para o contínuo, com \(t \approx n \tau\) e \(x \approx m \ell\) e interpretando \(p_n(m)\) como a probabilidade da partícula estar no intervalo \((m-1/2)\ell \leq x \leq (m+1/2)\ell,\) no instante \(t\) e sendo \(p(t, x)\) a densidade de probabilidades no instante \(t,\) temos</p>
\[
\int_{(m-1/2)\ell}^{(m+1/2)\ell} p(t, x)\;\mathrm{d}x = p_n(m).
\]
<p>Mas \(p_n(m)\) pode ser nulo quando \(n+m\) é ímpar, ou seja,</p>
\[
\int_{(m-1/2)\ell}^{(m+1/2)\ell} p(t, x)\;\mathrm{d}x = p_n(m) \begin{cases} = 0, & n + m \textrm{ ímpar,} \\ \approx \sqrt{\frac{2}{\pi n}}e^{\displaystyle -\frac{m^2}{2n}}, & n + m \textrm{ par.} \end{cases}
\]
<p>Para garantir que obtemos a probabilidade estimada acima, podemos integrar a densidade no intervalo &quot;dobrado&quot; \((m-1)\ell \leq x \leq (m+1)\ell.\) Assim, obtemos, aproximadamente,</p>
\[
2\ell p(t, x) \approx \int_{(m-1)\ell}^{(m+1)\ell} p(t, x)\;\mathrm{d}x = p_n(m) \approx \sqrt{\frac{2}{\pi n}}e^{-\frac{m^2}{2n}} = \sqrt{\frac{2\tau}{\pi t}}e^{-\frac{\tau x^2}{2t\ell^2}},
\]
<p>pelo menos para \(n \gg 1,\) \(|m| \ll n,\) ou seja, em particular, para</p>
\[
\frac{|x|}{\ell} \ll \frac{t}{\tau}.
\]
<p>Logo, nessa região,</p>
\[
p(t, x) \approx \sqrt{\frac{\tau}{2\ell^2 \pi t}} e^{-\frac{\tau x^2}{2t\ell^2}} = \frac{1}{\sqrt{4\pi a t}} e^{-\frac{x^2}{4a t}},
\]
<p>onde fizemos</p>
\[
a = \frac{\ell^2}{2\tau}.
\]
<p>Obtivemos, assim, que, para cada \(t,\) a função \(x \mapsto p(t, x)\) é aproximadamente uma Gaussiana com variância \(\sigma^2 = 2at.\)</p>
<p>Observe que podemos pensar esse processo limite como tomando \(\ell, \tau \rightarrow 0\) mas mantendo a relação \(a = \ell^2/2\tau\) fixa. Ou seja, \(\tau\) converge para zero muito mais rápido do que \(\ell.\) Em particular, fixados \(x \approx m\ell\) e \(t \approx n\tau,\) e fazendo \(\ell, \tau\) irem para zero, com \(a = \ell^2/2\tau\) fixo, vemos que \(m, n\rightarrow \infty,\) com \(n\) crescendo muito mais rápido que \(m,\) garantindo a condição de que \(|m| \ll n.\) Assim, a aproximação acima para \(p_n(m)/2\ell\) converge, de fato, para \(p(t, x).\)</p>
<p>A condição em \(t, x\) pode ser escrita como</p>
\[
\ell \ll |x| \ll \frac{\ell}{\tau} t = \frac{a}{2\ell} t.
\]
<p>À medida em que \(\ell, \tau \rightarrow 0\) com \(a\) fixo, temos também \(a/2\ell \rightarrow \infty,\) de modo que, no limite, a aproximação vale para todo \(x\in\mathbb{R}\) e para \(t > 0\) arbitrário. Ou seja, obtemos uma convergência em quase toda a parte e deduzimos que a aproximação normal acima vale em todo \((t, x) \in (0, \infty) \times \mathbb{R}.\)</p>
<p>Finalmente, observe a semelhança entre a definição de \(a\) acima e de \(D\) no modelo de Einstein, onde, no primeiro caso, o passo é fixo, enquanto que, no segundo caso, o passo é uma variável aleatória:</p>
\[
a = \frac{\ell^2}{2\tau}, \qquad D = \frac{\mathbb{E}(\ell^2)}{2\tau}.
\]
<p>De uma forma mais rigorosa, podemos definir, para cada \(\tau, \ell > 0,\) as distribuições constantes por parte</p>
\[
    \tilde p_{\tau, \ell}(t, x) = \frac{p_m(n)}{2\ell} = \frac{1}{2\ell}\frac{1}{2^n}\frac{n!}{\left(\frac{n + m}{2}\right)!\left(\frac{n-m}{2}\right)!}, \quad (m-1)\ell \leq x < (m+1)x, \;n\tau \leq t < (n+1)\tau, \;n\in \mathbb{Z}^*, \;m\in \mathbb{Z}, \;n+m \textrm{ par,}
\]
<p>ou as suas versões \(p_n(t, x)\) lineares por parte. Assim, podemos mostrar que</p>
\[
    \lim_{\tau, \ell \rightarrow 0, \tau/2\ell^2 = a} p_{\tau, \ell}(t, x) = p(t, x),
\]
<p>uniformemente em subconjuntos compactos de \((0, \infty) \times \mathbb{R}.\)</p>

<img src="/notas_sde/assets/pages/c01/passeioaleatorio_movbrowniano/code/output/randomwalklimit.gif" alt="">
<h2 id="processo_limite_do_passeio_aleatório"><a href="#processo_limite_do_passeio_aleatório" class="header-anchor">Processo limite do passeio aleatório</a></h2>
<p>Pensando nesse limite contínuo, e abusando da notação, já que já definimos \(X_n,\) podemos escrever \(X_t\) como a variável aleatória indicando a posição da partícula no instante \(t \sim n\tau,\) associado à distribuição limite \(p(t, x).\)</p>
<h2 id="equação_de_difusão"><a href="#equação_de_difusão" class="header-anchor">Equação de difusão</a></h2>
<p>Podemos reconhecer, pela fórmula acima, que a evolução, no tempo, da distribuição de probabilidades \(p(t, x)\) para a posição da partícula satisfaz a equação de difusão &#40;e.g. equação do calor&#41;</p>
\[
\frac{\partial p}{\partial t^2} = a\frac{\partial p}{\partial x^2},
\]
<p>onde \(a\) representa o coeficiente de difusão &#40;térmica, no caso do calor&#41;.</p>
<h2 id="distância_média_percorrida"><a href="#distância_média_percorrida" class="header-anchor">Distância média percorrida</a></h2>
<p>Como no modelo de Einstein, sendo \(x \mapsto p(t, x)\) uma Gaussiana com variância \(\sigma^2 = 2at,\) a <strong>distância quadrática média</strong> percorrida pelas partículas, após um instante \(t,\) é exatamente esse desvio padrão:</p>
\[
\sqrt{\mathbb{E}[X_t^2]} = \left( \int_{\mathbb{R}} x^2 p(t, x) \;\mathrm{d}x \right)^{1/2} = \sigma = \sqrt{2 a t}.
\]
<p>Se, por outro lado, observarmos \(\mathbb{E}(|X_t|),\) obtemos uma distância da mesma ordem: \(\mathbb{E}(|X_t|) = 2\int_0^\infty x p(t, x) \;\mathrm{d}x = \sigma\sqrt{2/\pi}.\)</p>
<h2 id="incrementos"><a href="#incrementos" class="header-anchor">Incrementos</a></h2>
<p>Em um instante \(t,\) a distribuição normal \(\mathcal{N}(0, 2at)\) nos dá a probabilidade de encontrarmos a partícula em uma determinada posição &#40;tendo ela partido de \(x = 0\) em \(t = 0\)&#41;. Mas dada a posição da partícula no instante \(t,\) a posição dessa partícula em um instante \(t + \Delta t,\) com \(\Delta t > 0\) não é dada por \(\mathcal{N}(0, 2a(t+\Delta t))\) pura e simplesmente.  Temos, na verdade, uma probabilidade condicionada.</p>
<p>Pensando, novamente, no passeio aleatório, podemos imaginar um novo processo iniciando-se em \(x = X_t\) e caminhando para \(x \pm \ell\) no instante \(t + \tau\) e para algum ponto entre \(x - n\ell \leq x + m\ell \leq x + n\ell,\) em instantes \(t + n\tau.\) Assim, o incremento \(\Delta X = X_{t + \Delta t} - X_t\) é dado, novamente, por um passeio aleatório, só que começando de \(X_t\) e durando um intervalo de tempo \(\Delta t.\) Ou seja, a lei de probabilidades para a posição \(X_{t + \Delta t}\) da partícula dado \(X_t\) é</p>
\[
X_{t + \Delta t} \sim \mathcal{N}(X_t, 2a\Delta t) = X_t + \mathcal{N}(0, 2a\Delta t).
\]
<p>Ou seja, a lei de probabilidades do incremento é</p>
\[
\Delta X = X_{t + \Delta t} - X_t \sim \mathcal{N}(0, 2a\Delta t).
\]
<h2 id="caminhos"><a href="#caminhos" class="header-anchor">Caminhos</a></h2>
<p>Como no modelo de Einstein, podemos ter, no limite, caminhos se deslocando cada vez mais rápido. De fato, ao longo de \(n\) passos de tempo \(\tau\) até um instante \(t,\) podemos ter exatos \(n\) passos \(\ell\) no mesmo sentido, digamos até \(x = n\ell,\) de modo que a velocidade é \(x/t = \ell/\tau.\) Fazemos \(\ell, \tau \rightarrow 0,\) com \(a = \ell^2/2\tau\) constante, enquanto aumentamos \(n\) e \(m\) para chegarmos ao ponto mais longe possível \(x,\) no mesmo instante \(t.\) Assim, temos a velocidade \(v = x/t = \ell/\tau = \sqrt{2a\tau}/\tau = \sqrt{2a/\tau} \rightarrow \infty.\) Ou seja, não há como limitar a velocidade dos caminhos.</p>
<p>Porém, como feito no modelo de Einstein, é possível mostrar que, com probabilidade um, os caminhos são Hölder contínuos, com expoente arbitrariamente próximo de 1/2.</p>
<h2 id="diferenças_finitas"><a href="#diferenças_finitas" class="header-anchor">Diferenças finitas</a></h2>
<p>Uma outra maneira de se trabalhar o limíte contínuo do passeio aleatório é via diferenças finitas. Pense em \(p(t, x) \sim p_n(m)\) como uma função densidade de partículas, como se cada \(m\in \mathbb{N}\) representasse um sítio, com um certo número \(u_n(m)\) de partículas, cuja densidade é \(p_n(m) = u_n(m) / U,\) onde \(U\) é o número total de partículas. A cada passo de tempo, em média metade das partículas em um sítio \(m\) se encaminha para o sítio \(m-1\) e a outra metade, para o sítio \(m+1.\) Por um outro ponto de vista, todas as partículas de um determinado sítio vão para os sítios vizinhos e metade das partículas de cada um dos sítios vizinhos se encaminha para aquele sítio. Ou seja, o total \(u_{n+1}(m)\) de partículas no sítio \(m,\) no passo \(n+1,\) é inteiramente constituído pelas partículas advindas dos sítios vizinhos, de forma que</p>
\[
  u_{n+1}(m) = \frac{1}{2}u_n(m-1) + \frac{1}{2}u_n(m+1).
\]
<p>Subtraindo \(u_n(m)\) dos dois lados, multiplicando a equação resultante por \(1/\tau = 2a/\ell^2\) e dividindo-a por \(U,\) obtemos</p>
\[
\frac{p_{n+1}(m) - p_n(m)}{\tau} = a\frac{p_n(m+1) - 2p_n(m) + p_n(m-1)}{\ell^2}
\]
<p>No limite quando \(\tau, \ell \rightarrow 0,\) com \(a = \ell^2/2\tau\) constante e com \(x \sim m\ell\) e \(t \sim n\tau,\) obtemos a equação em derivadas parciais</p>
\[
\frac{\partial p}{\partial t} = a\frac{\partial^2 p}{\partial x^2}.
\]
<h2 id="exercícios"><a href="#exercícios" class="header-anchor">Exercícios</a></h2>
<ol>
<li><p>Considere um passeio aleatório em três dimensões, onde o espaço é \(\ell \mathbb{Z}^3.\) Cada passo pode ser em qualquer direção, com oito possíveis destinos, \((\pm \ell, \pm \ell, \pm \ell),\) cada um com probabilidade \(1/2^3 = 1/8.\) Mostre que, no limite, a densidade de probabilidades \(p(t, \mathbf{x})\) da posição da partícula é dada por</p>
</li>
</ol>
\[
p(t, \mathbf{x}) = \frac{1}{(4\pi a t)^{3/2}} e^{-\frac{|\mathbf{x}|^2}{4Dt}}.
\]
<p>onde \(\mathbf{x} = (x, y, z),\) \(|\mathbf{x}| = \sqrt{x^2 + y^2 + z^2}\) e \(a\) é como no caso unidimensional.</p>
<ol start="2">
<li><p>Uma versão bidimensional pode ser feita com passos dados por \(\ell(\cos\theta, \sin\theta),\) com \(\ell > 0\) fixo indicando o tamanho do passo e \(\theta\) uma variável aleatória com probabilidade uniforme em \([0, 2\pi]\) indicando a direção do passo. Um passeio aleatório com \(n\) passos nos leva a</p>
</li>
</ol>
\[
(X_n, Y_n) = \ell \sum_{i = 1, \ldots, n} (\cos\theta_i, \sin\theta_i).
\]
<p>onde \(\theta_i\) são \(n\) realizações da variável ângulo. Usando que \(\theta\) segue uma distribuição uniforme, mostre que</p>
\[
\mathbb{E}((X_n, Y_n)) = (0, 0).
\]
<p>Mostre, ainda, usando também as relações \(\cos^2\theta = (1 + \cos(2\theta))/2\) e \(\sin^2\theta = (1 - \cos(2\theta))/2,\) que</p>
\[
\mathbb{E}(X_n^2 + Y_n^2) = n \frac{\ell^2}{2}.
\]
<p>Ou seja, a média quadrática da distância cresce linearmente com o número de passos.</p>

    <div class="navbar">
    <p id="nav">
<span id="nav-prev" style="float: left;">
<a class="menu-level-1" href="/notas_sde/pages/c01/modelo_einstein">1.4. O modelo de Einstein para o movimento Browniano <kbd>←</kbd></a>
</span>
<span id="nav-next" style="float: right;">
    <a class="menu-level-1" href="/notas_sde/pages/c01/modelo_bachelier"><kbd>→</kbd> 1.6. O modelo de Bachelier para o mercado de opções</a>
</span>
    </p>
</div>
</br></br>



<div class="page-foot">
    
        <div class="license">
            <a href=https://creativecommons.org/licenses/by-nc-nd/4.0/>(CC BY-NC-ND 4.0) Attribution-NonCommercial-NoDerivatives 4.0 International </a>
            Ricardo M. S. Rosa
        </div>
    

    Last modified: July 02, 2025. Built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a>, using the <a href="https://github.com/rmsrosa/booksjl-franklin-template">Book Template</a>.
</div><!-- CONTENT ENDS HERE -->

      </div> <!-- .books-content -->
    </div> <!-- .books-container -->

    
        <script src="/notas_sde/libs/katex/katex.min.js"></script>
        <script src="/notas_sde/libs/katex/auto-render.min.js"></script>
        <script>renderMathInElement(document.body)</script>
    

    
        <script src="/notas_sde/libs/highlight/highlight.pack.js"></script>
        <script>hljs.initHighlightingOnLoad();hljs.configure({tabReplace: '    '});</script>
    

  </body>
</html>
