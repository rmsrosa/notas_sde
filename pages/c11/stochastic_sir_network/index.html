<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="" />
  <meta name="author" content="and contributors" />
   <title>Modelo SIR estocástico estruturado em rede</title>  
  <link rel="shortcut icon" type="image/png" href="/notas_sde/assets/images/favicon_randgon.png"/>
  <link rel="stylesheet" href="/notas_sde/css/base.css"/>
  
  <script src="/notas_sde/libs/mousetrap/mousetrap.min.js"></script>

  
    <link rel="stylesheet" href="/notas_sde/libs/highlight/github.min.css">
    <script src="/notas_sde/libs/highlight/highlight.pack.js"></script>
    <script src="/notas_sde/libs/highlight/julia.min.js"></script>
    <script>
      document.addEventListener('DOMContentLoaded', (event) => {
        document.querySelectorAll('pre').forEach((el) => {
          hljs.highlightElement(el);
        });
      });
    </script>
  

  
    <link rel="stylesheet" href="/notas_sde/libs/katex/katex.min.css">
  
</head>

<body>

  <div class="books-container">

  <aside class="books-menu">
  <input type="checkbox" id="menu">
  <label for="menu">☰</label>

  <div class="books-title">
    <a href="/notas_sde/">Equações Diferenciais Estocásticas e Aleatórias</a>
  </div>

  <br />

  <div class="books-subtitle">
    Aspectos Teóricos e Numéricos
  </div>

  <br />

  <div class="books-author">
    <a href="https://rmsrosa.github.io">Ricardo M. S. Rosa</a>
  </div>

  <div class="books-menu-content">
    <div class="menu-level-1">
    <li>1. Introdução</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c01/apresentacao">1.1. Apresentação</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c01/aspectos_iniciais">1.2. Equações diferenciais aleatórias e estocásticas</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c01/movimento_browniano">1.3. Movimento Browniano</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c01/modelo_einstein">1.4. O modelo de Einstein para o movimento Browniano</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c01/passeioaleatorio_movbrowniano">1.5. Do passeio aleatório ao movimento Browniano</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c01/modelo_bachelier">1.6. O modelo de Bachelier para o mercado de opções</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c01/aspectos_numericos">1.7. Aspectos numéricos</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c01/simulacoes_intro">1.8. Simulações numéricas de modelos de crescimento natural</a></li>
    </div>
    <div class="menu-level-1">
    <li>2. Variáveis Aleatórias</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c02/definicao_va">2.1. Conceitos essenciais</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c02/exemplos_va_discretas">2.2. Variáveis aleatórias discretas</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c02/exemplos_va_continuas">2.3. Variáveis aleatórias contínuas</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c02/media_momentos">2.4. Média, variância e outros momentos</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c02/prob_condicionada">2.5. Probabilidade condicionada</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c02/desigualdades">2.6. Desigualdades fundamentais</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c02/multi_va">2.7. Variáveis aleatórias multivariadas</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c02/transformacoes">2.8. Transformações de variáveis aleatórias</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c02/convergencias">2.9. Tipos de convergências</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c02/borel_cantelli">2.10. Lema de Borel-Cantelli</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c02/teorema_central">2.11. Teorema Central do Limite</a></li>
    </div>
    <div class="menu-level-1">
    <li>3. O método de Monte-Carlo</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c03/monte_carlo">3.1. O método de Monte-Carlo no estudo de variáveis aleatórias</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c03/histograma">3.2. Histograma - estimando a distribuição de probabilidades</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c03/gerando_num_aleatorios">3.3. Gerando números aleatórios no computador</a></li>
    </div>
    <div class="menu-level-1">
    <li>4. Processos Estocásticos</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c04/definicao_pe">4.1. Conceitos essenciais</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c04/processos_discretos">4.2. Processos em tempos discretos</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c04/processos_continuos">4.3. Processos em tempos contínuos</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c04/tipos_processos">4.4. Classes de processos</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c04/filtracao">4.5. Filtração</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c04/cadeias_markov">4.6. Processos de Markov</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c04/continuity_kolmogorov">4.7. Teorema de Continuidade de Kolmogorov</a></li>
    </div>
    <div class="menu-level-1">
    <li>5. Processos de Wiener</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c05/definicao_processo_wiener">5.1. Definição</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c05/existencia_processo_wiener">5.2. Existência de processos de Wiener</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c05/propriedades_wiener">5.3. Propriedades de processos de Wiener</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c05/ruido_branco">5.4. Relação com ruído branco</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c05/simetrias_wiener">5.5. Simetrias de processos de Wiener</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c05/naodiferenciabilidade_wiener">5.6. Não diferenciabilidade quase sempre dos caminhos amostrais</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c05/variacao_ilimitada_wiener">5.7. Variação ilimitada dos caminhos amostrais</a></li>
    </div>
    <div class="menu-level-1">
    <li><a href="/notas_sde/pages/c06/integracao_estocastica">6. Integração estocástica</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c06/integral_riemann">6.1. Integrais de Riemann</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c06/integral_riemannstieltjes">6.2. Integrais de Riemann-Stieltjes</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c06/integral_dualidade">6.3. Integrais via dualidade</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c06/riemann_wiener">6.4. Limites de somatórios à la Riemann-Stieltjes</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c06/integral_ito">6.5. Integral de Itô via processos uniformemente contínuos em média quadrática</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c06/integral_ito_l2">6.6. Integral de Itô via processos do tipo escada</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c06/integral_ito_propriedades">6.7. Propriedades da integral de Itô</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c06/formula_ito">6.8. Fórmula de Itô</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c06/integral_stratonovich">6.9. Integral de Stratonovich</a></li>
    </div>
    <div class="menu-level-1">
    <li>7. Equações diferenciais aleatórias</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c07/existence_solutions_rde">7.1. Existência e unicidade de soluções</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c07/basic_examples_rde">7.2. Exemplos básicos</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c07/logistic_rde">7.3. Equação logística aleatória</a></li>
    </div>
    <div class="menu-level-1">
    <li>8. Equações diferenciais estocásticas</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c08/setting">8.1. Interpretação da equação</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c08/existence_solutions_sde_particulares">8.2. Existência de soluções locais em casos particulares</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c08/existence_solutions_sde">8.3. Existência de soluções globais</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c08/unicidade_sol_sde">8.4. Unicidade de soluções</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c08/continuidade_caminhos">8.5. Limitação e continuidade das soluções</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c08/linear_sde">8.6. Resolução de equações lineares</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c08/geometric_brownian">8.7. Movimento Browniano geométrico e o preço de ações</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c08/brownian_bridge">8.8. Ponte Browniana</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c08/ornstein_uhlenbeck">8.9. A equação de Langevin e o processo de Ornstein-Uhlenbeck</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c08/ou_aproxima_ruidobranco">8.10. O processo de Ornstein-Uhlenbeck como aproximação de um ruído branco</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c08/asymptotic_stability">8.11. Estabilidade assintótica</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c08/relacoes_rode_sde">8.12. Relações entre equações estocásticas e equações aleatórias</a></li>
    </div>
    <div class="menu-level-1">
    <li>9. Evolução da função densidade de probabilidade</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c09/deterministic">9.1. Equação do transporte no caso de equações diferenciais ordinárias</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c09/stochastic">9.2. Equação de Fokker-Planck no caso de equações estocásticas</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c09/stationaryOU">9.3. Distribuição assintótica estacionária dos processos de Ornstein-Uhlenbeck</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c09/feynmann_kac">9.4. Fórmula de Feynman-Kac e a equação retrógrada de Kolmogorov</a></li>
    </div>
    <div class="menu-level-1">
    <li>10. Métodos numéricos</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c10/tx_convergencia">10.1. Convergências forte e fraca</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c10/simulacoes_wiener">10.2. Simulações de processos de Wiener e browniano geométrico</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c10/convergencia_euler_maruyama">10.3. Convergência forte do método de Euler-Maruyama</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c10/nao_convergencia_euler_maruyama">10.4. Não convergência do método de Euler-Maruyama sem condição Lipschitz global</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c10/simulacoes_convergencia_em">10.5. Simulações ilustrando ordem de  convergência do método de Euler-Maruyama</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c10/heun">10.6. Método de Heun</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c10/simulacoes_convergencia_randomheun">10.7. Simulações ilustrando ordem de convergência do método de Heun para equações diferenciais aleatórias</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c10/milstein">10.8. O método de Milstein</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c10/simulacoes_milstein">10.9. Simulações Milstein</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c10/convergencia_fraca_em">10.10. Convergência fraca do método de Euler-Maruyama</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c10/sciml">10.11. O ambiente SciML da linguagem Julia</a></li>
    </div>
    <div class="menu-level-1">
    <li>11. Sistemas de equações aleatórias</li>
    </div>
    <div class="menu-level-1">
    <li>12. Sistemas de equações estocásticas</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c11/nuclear_reactions">12.1. Reações nucleares</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c11/stochastic_sir">12.2. Modelo SIR estocástico</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c11/stochastic_sir_network">12.3. Modelo SIR estocástico estruturado em rede</a></li>
    </div>
    <div class="menu-level-1">
    <li>Apêndice</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/appendix/teo_fund_kolmogorov">Teorema Fundamental de Kolmogorov</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/appendix/teo_extension_kolmogorov">Teorema de Extensão de Kolmogorov</a></li>
    </div>
    <div class="menu-level-1">
    <li><a href="/notas_sde/pages/references">References</a></li>
    </div>
<div>


  
    <a href="https://github.com/rmsrosa/notas_sde"><img src="/notas_sde/assets/images/GitHub-Mark-32px.png" alt="GitHub repo" width="18" style="margin:5px 5px" align="left"></a>

  

</aside>


  <div class="books-content">

    
      <div class="navbar">
    <p id="nav">
<span id="nav-prev" style="float: left;">
<a class="menu-level-1" href="/notas_sde/pages/c11/stochastic_sir">12.2. Modelo SIR estocástico <kbd>←</kbd></a>
</span>
<span id="nav-next" style="float: right;">
    <a class="menu-level-1" href="/notas_sde/pages/appendix/teo_fund_kolmogorov"><kbd>→</kbd> Teorema Fundamental de Kolmogorov</a>
</span>
    </p>
</div>
</br></br>

    

    
      
    
<h1 id="get_title"><a href="#get_title" class="header-anchor">12.3. Modelo SIR estocástico estruturado em rede</a></h1>
<p>Uma componente importante em epidemiologia é a característica heterogênea dos parâmetros epidemiológicos e sociais. Os indivíduos têm, naturalmente, diferentes comportamentos e diferentes capacidades de serem infectados e de se recuperarem de uma doença. Os modelos compartimentais são homogêneos por princípio e não são capazes de capturar essa heterogeneidade.</p>
<p>Modelos mais realistas devem levar esse heterogeneidade em consideração. Num caso extremo, podemos modelar cada indivíduo separadamente. Isso é custoso, tanto no aspecto da simulação computacional &#40;imagine modelar milhões de indivíduos em uma cidade grande ou em estado ou país&#41; como no de ajuste e escolha dos parâmetros apropriados.</p>
<p>Uma modelagem intermediária é dividir a população em grupos e assumir a homogeneidade apenas dentro desse grupos. A divisão pode ser feita em termos geográficos &#40;e.g. diferentes bairros em uma cidade&#41;, comportamentais &#40;e.g. diferentes grupos sociais ou de trabalho&#41;, sociais &#40;e.g. diferentes condições de vida&#41;, de saúde &#40;e.g. diferentes grupos de risco&#41;, etc.</p>
<p>Nesses casos, os grupos podem ser vistos como vértices de um grafo e a interação entre os diferentes grupos pode ser vista como sendo as arestas do grafo. Tais modelos são classificados como modelos em rede. Em cima dessa estrutura de grafo/rede, podemos considerar uma dinâmica determinística ou estocástica. E a evolução pode ser discreta ou contínua, no tempo. Além disso, a natureza da epidemia também pode ser variada &#40;se há reinfecção ou não, se leva expostos em consideração ou não, etc.&#41;</p>
<p>Aqui, vamos construir um modelo do tipo SIR, considerando os estados epidemiológicos  <em>suscetíveis,</em> <em>infectados</em> e <em>recuperados</em>, em cada grupo. No que se segue, podemos pensar nas regiões como sendo diferentes áreas residenciais, mas vale ressaltar que, em termos do sistema de equações, é indiferente o que cada grupo representa. Isso é relevante, apenas, na definição e na interpretação dos diferentes parâmetros que aparecem no modelo. </p>
<p>Vamos, então, imaginar que a população está estruturada em diferentes regiões geográficas e que os parâmetros epidemiológicos &#40;taxas de contágio e de recuperação&#41; variam de região para região. Vamos imaginar que, ao longo de cada unidade de tempo &#40;e.g. um dia&#41;, parte da população de uma região passe parte do tempo em uma das outras regiões. E vamos assumir que esse deslocamento não seja sempre o mesmo, todos os dias, permitindo que ele varie estocásticamente ao longo do tempo.</p>
<p>Vamos começar com o modelo em rede determinístico. Em seguida, adicionamos os termos estocásticos.</p>
<h2 id="carregando_os_pacotes_necessários"><a href="#carregando_os_pacotes_necessários" class="header-anchor">Carregando os pacotes necessários</a></h2>
<p>Nas simulações, vamos usar o ambiente <a href="https://sciml.ai">SciML</a>, da <a href="https://sciml.ai">linguagem Julia</a>. Como vamos simular tanto sistema determinísticos como estocásticos, carregamos o <a href="https://github.com/SciML/OrdinaryDiffEq.jl">SciML/OrdinaryDiffEq</a> e o <a href="https://github.com/SciML/StochasticDiffEq.jl">SciML/StochasticDiffEq</a>.</p>
<pre><code class="language-julia">using OrdinaryDiffEq
using StochasticDiffEq

using Plots</code></pre>

<h2 id="modelo_sir_determinístico_em_rede"><a href="#modelo_sir_determinístico_em_rede" class="header-anchor">Modelo SIR determinístico em rede</a></h2>
<p>Agora, passamos para o modelo SIR em rede, no caso determinístico. Vamos assumir três sítios, denotados por \(A,\) \(B\) e \(C.\)</p>
<h2 id="modelo_sir_em_rede_de_sítios"><a href="#modelo_sir_em_rede_de_sítios" class="header-anchor">Modelo SIR em rede de sítios</a></h2>
<h3 id="representação_do_sistema"><a href="#representação_do_sistema" class="header-anchor">Representação do sistema</a></h3>
<p>Nesse caso, consideramos </p>
<ul>
<li><p>\(m\)<strong>sítios</strong>.</p>
</li>
<li><p>Em cada sítio, uma <strong>população total</strong> \(N_i,\) com um número \(S_i\) de <strong>suscetíveis</strong>, \(I_i\) de <strong>infectados</strong> e \(R_i\) de <strong>recuperados</strong>, \(i=1, \ldots, m.\)</p>
</li>
<li><p>Sem vitalidade, de forma que \(S_i + I_i + R_i = N_i\) é constante, para cada \(i=1, \ldots, m.\)</p>
</li>
</ul>
<h3 id="dinâmica"><a href="#dinâmica" class="header-anchor">Dinâmica</a></h3>
<ul>
<li><p>Denominamos por <strong>um ciclo</strong> cada unidade de tempo, digamos um dia.</p>
</li>
<li><p>O <strong>ciclo</strong> possui uma fase <strong>ativa</strong>, onde a infeção pode ocorrer, e uma fase <strong>inativa</strong>, onde não há transmissão da infecção.</p>
</li>
<li><p>Na fase <strong>ativa</strong> de cada ciclo, uma <strong>fração</strong> \(\alpha_{ij}\) da população \(N_i\) migra <strong>do sítio \(i\) para o sítio \(j\)</strong>, voltando ao sítio \(i\) na fase <strong>inativa</strong>.</p>
</li>
<li><p>Naturalmente, \(0\leq \alpha_{ij} \leq 1,\) para cada \(i,j=1, \ldots, m,\) e \(\sum_{j=1}^m\alpha_{ij} = 1,\) para cada \(i=1,\ldots, m.\)</p>
</li>
<li><p>Em cada sítio \(j=1, \ldots, m,\) os indivíduos <strong>suscetíveis</strong> que lá se encontram podem se tornar <strong>infectados</strong> ao encontrar um indivíduo infectado no mesmo sítio, com um <strong>fator de transmissão</strong> \(\beta_j\) característico do sítio \(j\) em que se encontram.</p>
</li>
<li><p>Os indivíduos <strong>infectados</strong> de cada sítio, podem se recuperar com um <strong>fator de recuperação</strong> \(\gamma_i,\) característico do ambiente e dos indivíduos que habitam o sítio.</p>
</li>
</ul>
<h3 id="sistema_de_equações_diferenciais"><a href="#sistema_de_equações_diferenciais" class="header-anchor">Sistema de equações diferenciais</a></h3>
<p>Temos o sistema</p>
\[
\begin{cases}
  \displaystyle \frac{\rm d S_i}{\rm d t} = - \sum_{j=1}^m \sum_{k=1}^m \beta_j\alpha_{kj}\alpha_{ij}\frac{I_k}{\tilde N_j}S_i, & i = 1, \ldots, m, \\
  \displaystyle \frac{\rm d I_i}{\rm d t} = \sum_{j=1}^m \sum_{k=1}^m \beta_j\alpha_{kj}\alpha_{ij}\frac{I_k}{\tilde N_j}S_i - \gamma_i I_i, & i = 1, \ldots, m, \\
  \displaystyle \frac{\rm d R_i}{\rm d t} = \gamma_i I_i, & i = 1, \ldots, m,
\end{cases}
\]
<p>onde</p>
\[ \tilde N_j = \sum_{i=1}^n \alpha_{ij}N_i, \qquad j = 1, \ldots, m,
\]
<p>é a população existente no sítio \(j\) durante a fase ativa do ciclo.</p>
<h3 id="conservação_da_população_total_de_cada_sítio"><a href="#conservação_da_população_total_de_cada_sítio" class="header-anchor">Conservação da população total de cada sítio</a></h3>
<p>Podemos verificar, como esperado da modelagem, que a população total originária de cada sítio permanece constante:</p>
\[ \frac{\rm d N_i}{\rm d t}  = \frac{\rm d}{\rm d t}\left( S_i + I_i + R_i \right) = 0.
\]
<p>Assim, </p>
\[ N_i = S_i + I_i + R_i = \text{ constante}, \qquad \forall i =1, \ldots, m.
\]
<p>Como consequência, também temos que a população em cada sítio durante a fase ativa do ciclo também é constante:</p>
\[ \tilde N_j = \sum_{i=1}^n \alpha_{ij}N_i = \text{ constante}, \qquad \forall j = 1, \ldots, m.
\]
<h3 id="redução_do_sistema"><a href="#redução_do_sistema" class="header-anchor">Redução do sistema</a></h3>
<p>Como no caso do modelo SIR clássico, podemos reduzir o sistema a um subsistema envolvendo apenas <strong>suscetíveis</strong> e <strong>infectados</strong>, considerando que a população total é constante.</p>
<p>Temos </p>
\[ R_i = N_i - S_i - I_i
\]
<p>e basta consideramos</p>
\[
\begin{cases}
  \displaystyle \frac{\rm d S_i}{\rm d t} = - \sum_{j=1}^m \sum_{k=1}^m \beta_j\alpha_{kj}\alpha_{ij}\frac{I_k}{\tilde N_j}S_i, & i = 1, \ldots, m, \\
  \displaystyle \frac{\rm d I_i}{\rm d t} = \sum_{j=1}^m \sum_{k=1}^m \beta_j\alpha_{kj}\alpha_{ij}\frac{I_k}{\tilde N_j}S_i - \gamma_i I_i, & i = 1, \ldots, m,
\end{cases}
\]
<p>onde</p>
\[ \tilde N_j = \sum_{i=1}^n \alpha_{ij}N_i, \qquad j=1, \ldots, m,
\]
<p>são constantes.</p>
<h3 id="representação_vetorial"><a href="#representação_vetorial" class="header-anchor">Representação vetorial</a></h3>
<p>Considerando os estados na forma de vetores, </p>
\[ S=(S_1, \ldots, S_m), \qquad I = (I_1, \ldots, I_m),
\]
<p>podemos escrever as equações na forma vetorial</p>
\[
\begin{cases}
  \displaystyle \frac{\rm d S}{\rm d t} = - \rm{diag}(AI)S, \\
  \displaystyle \frac{\rm d I}{\rm d t} = \rm{diag}(AI)S - \Gamma I,
\end{cases}
\]
<p>onde </p>
<ul>
<li><p>\(\Gamma\) é a matriz diagonal \(\Gamma = \rm{diag}(\gamma_1, \ldots, \gamma_m),\) </p>
</li>
<li><p>\(A\) é a matriz</p>
</li>
</ul>
\[ A = \left(\sum_{j=1}^m\frac{\beta_j\alpha_{kj}\alpha_{ij}}{\tilde N_j}\right)_{ik}
\]
<ul>
<li><p>\(\rm{diag}(AI)\) é a matriz diagonal formada pelo vetor obtido da aplicação da matriz \(A\) ao vetor \(I,\)</p>
</li>
</ul>
\[ AI = \left(\sum_{k=1}^m\sum_{j=1}^m\frac{\beta_j\alpha_{kj}\alpha_{ij}}{\tilde N_j} I_k\right)_i
\]
<h3 id="matriz_de_fluxo"><a href="#matriz_de_fluxo" class="header-anchor">Matriz de fluxo</a></h3>
<p>A key component of the network model is the flux matrix, defining the fraction of the population and of the time that the residents of a given site spend in another site.</p>
<p>We denote this matrix by \(\phi = (\phi_{ij})_{i,j}.\)</p>
<p>More precisely, each individual \(k=1, \ldots, N_i\) in site \(i\) may spend a time \(\theta^k_{i,j}\) in site \(j,\) during a specified unit of time. In this case,</p>
\[
  0 \leq \theta^k_{ij} \leq 1, \qquad \sum_j \theta^k_{i,j} = 1.
\]
<p>We then define \(\phi_{ij} = (1/N_i)\sum_{k=1}^{N_i} \theta^k_{i,j}.\) Notice</p>
\[
0 \leq \phi_{ij} \leq 1, \qquad \sum_j \phi_{ij} = 1.
\]
<h3 id="parâmetros_para_os_sítios_a_b_e_c"><a href="#parâmetros_para_os_sítios_a_b_e_c" class="header-anchor">Parâmetros para os sítios A, B e C.</a></h3>
<p>Population in each site:</p>
<pre><code class="language-julia">N &#61; 100_000
pop &#61; &#91;0.1; 0.7; 0.2&#93; * N</code></pre>

<p>Flux &#40;commuting&#41; matrix</p>
<pre><code class="language-julia">phi &#61; &#91;
    0.6 0.1 0.3
    0.3 0.4 0.3
    0.2 0.3 0.5
&#93;</code></pre>

<p>Infectivity and recovery rates in each site</p>
<pre><code class="language-julia">sites_beta &#61; &#91;
    0.2
    0.4
    0.3
&#93;

sites_gamma &#61; &#91;
    0.3
    0.1
    0.2
&#93;</code></pre>

<h3 id="evolution_law"><a href="#evolution_law" class="header-anchor">Evolution law</a></h3>
<pre><code class="language-julia">function SIR_network&#33;&#40;du, u, p, t&#41;
    S, I &#61; eachrow&#40;u&#41;
    M &#61; length&#40;S&#41;
    Nd, phi, beta, gamma &#61; p
    for i in 1:M
        infections_i &#61; sum&#40;
            &#91;beta&#91;j&#93; * phi&#91;i,j&#93; * phi&#91;k,j&#93; * S&#91;i&#93; * I&#91;k&#93; / Nd&#91;j&#93; for k&#61;1:M, j&#61;1:M&#93;
        &#41;
        du&#91;1,i&#93; &#61; dS &#61; - infections_i
        du&#91;2,i&#93; &#61; dI &#61; infections_i - gamma&#91;i&#93; * I&#91;i&#93;
    end
end</code></pre>

<h3 id="setup"><a href="#setup" class="header-anchor">Setup</a></h3>
<p>Collecting the parameters</p>
<pre><code class="language-julia">Nd &#61; transpose&#40;phi&#41; * pop # population in each site &quot;during the day&quot;
parm_network &#61; &#40;Nd, phi, sites_beta, sites_gamma&#41;</code></pre>

<p>Initial conditions</p>
<pre><code class="language-julia">inf0 &#61; 10
popinf0 &#61; &#91;0.8, 0.2, 0.0&#93; * inf0
pop0 &#61; &#91;pop&#39; - popinf0&#39;; popinf0&#39;&#93;

t0 &#61; 0.0
tf &#61; 360.0
tspan &#61; &#40;t0, tf&#41;

SIR_network_prob &#61; ODEProblem&#40;SIR_network&#33;, pop0, tspan, parm_network&#41;</code></pre>

<h3 id="solution"><a href="#solution" class="header-anchor">Solution</a></h3>
<pre><code class="language-julia">SIR_network_sol &#61; solve&#40;SIR_network_prob, Tsit5&#40;&#41;&#41;

SIR_network_sol.retcode</code></pre>

<pre><code class="language-julia">plot&#40;xlabel &#61; &quot;time &#40;days&#41;&quot;, ylabel &#61; &quot;population fraction&quot;, ylims &#61; &#40;0.0, 1.0&#41;&#41;
for &#40;j, s&#41; in zip&#40;1:3, &#39;A&#39;:&#39;C&#39;&#41;
    plot&#33;&#40;getindex.&#40;SIR_network_sol.u, 1, j&#41;/pop&#91;j&#93;, label &#61; &quot;Site &#36;s&quot;&#41;
end
plot&#33;&#40;title &#61; &quot;Fraction of susceptible individuals in each site&quot;, titlefont &#61; 10&#41;

plot&#40;xlabel &#61; &quot;time &#40;days&#41;&quot;, ylabel &#61; &quot;population fraction&quot;&#41;
for &#40;j, s&#41; in zip&#40;1:3, &#39;A&#39;:&#39;C&#39;&#41;
    plot&#33;&#40;getindex.&#40;SIR_network_sol.u, 2, j&#41;/pop&#91;j&#93;, label &#61; &quot;Site &#36;s&quot;&#41;
end
plot&#33;&#40;title &#61; &quot;Fraction of infected individuals in each site&quot;, titlefont &#61; 10&#41;</code></pre>
<p><img src="/notas_sde/assets/pages/c11/stochastic_sir_network/code/output/plot_sol_sir_network_1.svg" alt=""> <img src="/notas_sde/assets/pages/c11/stochastic_sir_network/code/output/plot_sol_sir_network_2.svg" alt=""></p>
<h2 id="modelos_sir_estocástico_em_rede"><a href="#modelos_sir_estocástico_em_rede" class="header-anchor">Modelos SIR estocástico em rede</a></h2>

    <div class="navbar">
    <p id="nav">
<span id="nav-prev" style="float: left;">
<a class="menu-level-1" href="/notas_sde/pages/c11/stochastic_sir">12.2. Modelo SIR estocástico <kbd>←</kbd></a>
</span>
<span id="nav-next" style="float: right;">
    <a class="menu-level-1" href="/notas_sde/pages/appendix/teo_fund_kolmogorov"><kbd>→</kbd> Teorema Fundamental de Kolmogorov</a>
</span>
    </p>
</div>
</br></br>



<div class="page-foot">
    
        <div class="license">
            <a href=https://creativecommons.org/licenses/by-nc-nd/4.0/>(CC BY-NC-ND 4.0) Attribution-NonCommercial-NoDerivatives 4.0 International </a>
            Ricardo M. S. Rosa
        </div>
    

    Last modified: June 23, 2025. Built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a>, using the <a href="https://github.com/rmsrosa/booksjl-franklin-template">Book Template</a>.
</div><!-- CONTENT ENDS HERE -->

      </div> <!-- .books-content -->
    </div> <!-- .books-container -->

    
        <script src="/notas_sde/libs/katex/katex.min.js"></script>
        <script src="/notas_sde/libs/katex/auto-render.min.js"></script>
        <script>renderMathInElement(document.body)</script>
    

    
        <script src="/notas_sde/libs/highlight/highlight.pack.js"></script>
        <script>hljs.initHighlightingOnLoad();hljs.configure({tabReplace: '    '});</script>
    

  </body>
</html>
