<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="" />
  <meta name="author" content="and contributors" />
   <title>O método de Milstein</title>  
  <link rel="shortcut icon" type="image/png" href="/notas_sde/assets/images/favicon_randgon.png"/>
  <link rel="stylesheet" href="/notas_sde/css/base.css"/>
  
  <script src="/notas_sde/libs/mousetrap/mousetrap.min.js"></script>

  

  
    <link rel="stylesheet" href="/notas_sde/libs/katex/katex.min.css">
  
</head>

<body>

  <div class="books-container">

  <aside class="books-menu">
  <input type="checkbox" id="menu">
  <label for="menu">☰</label>

  <div class="books-title">
    <a href="/notas_sde/">Equações Diferenciais Estocásticas e Aleatórias</a>
  </div>

  <br />

  <div class="books-subtitle">
    Aspectos Teóricos e Numéricos
  </div>

  <br />

  <div class="books-author">
    <a href="https://rmsrosa.github.io">Ricardo M. S. Rosa</a>
  </div>

  <div class="books-menu-content">
    <div class="menu-level-1">
    <li>1. Introdução</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c01/apresentacao">1.1. Apresentação</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c01/aspectos_iniciais">1.2. Equações diferenciais aleatórias e estocásticas</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c01/aspectos_numericos">1.3. Aspectos numéricos</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/literated/c01/simulacoes_numericas">1.4. Simulações numéricas de modelos de crescimento natural</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c01/movimento_Browniano">1.5. Movimento Browniano</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c01/passeioaleatorio_movBrowniano">1.6. Do passeio aleatório ao movimento Browniano</a></li>
    </div>
    <div class="menu-level-1">
    <li>2. Variáveis Aleatórias</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c02/definicao_va">2.1. Conceitos essenciais</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c02/exemplos_va_discretas">2.2. Variáveis aleatórias discretas</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c02/exemplos_va_continuas">2.3. Variáveis aleatórias contínuas</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c02/media_momentos">2.4. Média, variância e outros momentos</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c02/prob_condicionada">2.5. Probabilidade condicionada</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c02/desigualdades">2.6. Desigualdades importantes</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c02/multi_va">2.7. Variáveis aleatórias multivariadas</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c02/transformacoes">2.8. Transformações de variáveis aleatórias</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c02/convergencias">2.9. Tipos de convergências</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c02/borel_cantelli">2.10. Lema de Borel-Cantelli</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c02/teorema_central">2.11. Teorema Central do Limite</a></li>
    </div>
    <div class="menu-level-1">
    <li>3. O método de Monte-Carlo</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c03/monte_carlo">3.1. O método de Monte-Carlo no estudo de variáveis aleatórias</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c03/histograma">3.2. Histograma - estimando a distribuição de probabilidades</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c03/gerando_num_aleatorios">3.3. Gerando números aleatórios no computador</a></li>
    </div>
    <div class="menu-level-1">
    <li>4. Processos Estocásticos</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c04/definicao_pe">4.1. Conceitos essenciais</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c04/processos_discretos">4.2. Processos discretos</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c04/processos_continuos">4.3. Processos contínuos</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c04/tipos_processos">4.4. Tipos de processos</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c04/filtracao">4.5. Filtração</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c04/cadeias_markov">4.6. Processos de Markov</a></li>
    </div>
    <div class="menu-level-1">
    <li>5. Processos de Wiener</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c05/definicao_processo_wiener">5.1. Definição</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c05/existencia_processo_wiener">5.2. Existência de processos de Wiener</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c05/simetrias_wiener">5.3. Simetrias de processos de Wiener</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c05/naodiferenciabilidade_wiener">5.4. Não diferenciabilidade quase sempre dos caminhos amostrais</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c05/variacao_ilimitada_wiener">5.5. Variação ilimitada quase sempre dos caminhos amostrais</a></li>
    </div>
    <div class="menu-level-1">
    <li>6. Integração estocástica</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c06/integral_riemann">6.1. Integrais de Riemann</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c06/integral_riemannstieltjes">6.2. Integrais de Riemann-Stieltjes</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c06/integral_dualidade">6.3. Integrais via dualidade</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c06/riemann_wiener">6.4. Limites de somatórios à la Riemann-Stieltjes</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c06/integral_ito">6.5. Integral de Itô</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c06/integral_ito_propriedades">6.6. Propriedades da integral de Itô</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c06/formula_ito">6.7. Fórmula de Itô</a></li>
    </div>
    <div class="menu-level-1">
    <li>7. Equações diferenciais aleatórias</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c07/existence_solutions_rde">7.1. Existência e unicidade de soluções</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c07/basic_examples_rde">7.2. Exemplos básicos</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c07/logistic_rde">7.3. Equação logística aleatória</a></li>
    </div>
    <div class="menu-level-1">
    <li>8. Equações diferenciais estocásticas</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c08/setting">8.1. Interpretação da equação</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c08/existence_solutions_sde_particulares">8.2. Existência de soluções em casos particulares</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c08/existence_solutions_sde">8.3. Existência de soluções no caso geral</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c08/unicidade_sol_sde">8.4. Unicidade de soluções</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c08/continuidade_caminhos">8.5. Continuidade dos caminhos amostrais</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c08/linear_sde">8.6. Resolução de equações lineares</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c08/geometric_brownian">8.7. Movimento Browniano geométrico e o preço de ações</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c08/brownian_bridge">8.8. Ponte Browniana</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c08/ornstein_uhlenbeck">8.9. O processo de Ornstein-Uhlenbeck e a equação de Langevin</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c08/feynmann_kac">8.10. Fórmula de Feynman-Kac</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c08/relacoes_rode_sde">8.11. Relações entre equações estocásticas e equações aleatórias</a></li>
    </div>
    <div class="menu-level-1">
    <li>9. Métodos numéricos</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c09/tx_convergencia">9.1. Convergências forte e fraca</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c09/simulacoes_wiener">9.2. Simulações de processos de Wiener e browniano geométrico</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c09/convergencia_euler_maruyama">9.3. Convergência do método de Euler-Maruyama</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c09/simulacoes_convergencia_em">9.4. Simulações ilustrando ordem de  convergência do método de Euler-Maruyama</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c09/heun">9.5. Método de Heun</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c09/milstein">9.6. O método de Milstein</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c09/simulacoes_milstein">9.7. Simulações Milstein</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c09/sciml">9.8. O ambiente SciML da linguagem Julia</a></li>
    </div>
    <div class="menu-level-1">
    <li>10. Evolução da função densidade de probabilidade</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/c10/deterministic">10.1. Evolução no caso de equações determinísticas</a></li>
    </div>
    <div class="menu-level-2">
    <li>10.2. Evolução no caso de equações aleatórias</li>
    </div>
    <div class="menu-level-2">
    <li>10.3. Kolmogorov backward equation</li>
    </div>
    <div class="menu-level-2">
    <li>10.4. Kolmogorov forward equation</li>
    </div>
    <div class="menu-level-2">
    <li>10.5. Evolução no caso de equações estocásticas</li>
    </div>
    <div class="menu-level-2">
    <li>10.6. Soluções estacionárias</li>
    </div>
    <div class="menu-level-2">
    <li>10.7. Métodos numéricos</li>
    </div>
    <div class="menu-level-1">
    <li>11. Sistemas de equações aleatórias</li>
    </div>
    <div class="menu-level-1">
    <li>12. Sistemas de equações estocásticas</li>
    </div>
    <div class="menu-level-1">
    <li>Apêndice</li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/appendix/teo_fund_kolmogorov">Teorema Fundamental de Kolmogorov</a></li>
    </div>
    <div class="menu-level-2">
    <li><a href="/notas_sde/pages/appendix/teo_extension_kolmogorov">Teorema de Extensão de Kolmogorov</a></li>
    </div>
    <div class="menu-level-1">
    <li><a href="/notas_sde/pages/references">References</a></li>
    </div>
<div>


  
    <a href="https://github.com/rmsrosa/notas_sde"><img src="/notas_sde/assets/images/GitHub-Mark-32px.png" alt="GitHub repo" width="18" style="margin:5px 5px" align="left"></a>

  

</aside>


  <div class="books-content">

    
      <div class="navbar">
    <p id="nav">
<span id="nav-prev" style="float: left;">
<a class="menu-level-1" href="/notas_sde/pages/c09/heun">9.5. Método de Heun <kbd>←</kbd></a>
</span>
<span id="nav-next" style="float: right;">
    <a class="menu-level-1" href="/notas_sde/pages/c09/simulacoes_milstein"><kbd>→</kbd> 9.7. Simulações Milstein</a>
</span>
    </p>
</div>
</br></br>

    

    
      
    
<h1 id="get_title"><a href="#get_title" class="header-anchor">9.6. O método de Milstein</a></h1>
<p>Vimos que o método de Euler-Maruyama para equações estocásticas multiplicativas é de ordem forte \(1/2\), ao contrário do método de Euler clássico, que é de ordem \(1\). É natural buscarmos de métodos de ordem mais alta também para equações estocásticas. Vamos ver, aqui, o método de Milstein, que é de ordem forte \(1\).</p>
<p>Para simplificar, vamos considerar equações diferenciais estocásticas <em>autônomas,</em> da forma</p>
\[
\mathrm{d}X_t = f(X_t)\;\mathrm{d}t + g(X_t)\;\mathrm{d}W_t.
\]
<p>Mas o caso não autônomo pode ser tratado de forma análoga. Vamos considerar, ainda, uma condição inicial</p>
\[
\left. X_t \right|_{t = 0} = X_0.
\]
<h2 id="expansão_de_taylor_estocástica"><a href="#expansão_de_taylor_estocástica" class="header-anchor">Expansão de Taylor estocástica</a></h2>
<p>A equação diferencial estocástica é interpretada como sendo</p>
\[
X_t = X_0 + \int_0^t f(X_s)\;\mathrm{d}s + \int_0^t g(X_s)\;\mathrm{d}W_s.
\]
<p>A partir de um determinado ponto \(t_0 \geq 0\), podemos escrever</p>
\[
X_t = X_{t_0} + \int_{t_0}^t f(X_s)\;\mathrm{d}s + \int_{t_0}^t g(X_s)\;\mathrm{d}W_s.
\]
<p>A ideia é usar a isometria de Itô para reescrever os integrandos acima e obter uma expansão da solução nos pontos da malha.</p>
<p>Pela isometria de Itô, temos</p>
\[
\mathrm{d}f(X_t) = f'(X_t)\;\mathrm{d}X_t + \frac{1}{2}f''(X_t)\;\mathrm{d}t = f'(X_t)f(X_t)\;\mathrm{d}t + f'(X_t)g(X_t)\;\mathrm{d}W_t + \frac{1}{2}f''(X_t)g(X_t)^2\;\mathrm{d}t.
\]
<p>e</p>
\[
\mathrm{d}g(X_t) = g'(X_t)\mathrm{d}X_t + \frac{1}{2}g''(X_t)\;\mathrm{d}t = g'(X_t)f(X_t)\;\mathrm{d}t + g'(X_t)g(X_t)\;\mathrm{d}W_t + \frac{1}{2}g''(X_t)g(X_t)^2\;\mathrm{d}t.
\]
<p>A partir do ponto \(t_0\), obtemos</p>
\[
f(X_s) = f(X_{t_0}) + \int_{t_0}^s f'(X_s)f(X_s)\;\mathrm{d}s + \int_{t_0}^s f'(X_s)g(X_s)\;\mathrm{d}W_s + \int_{t_0}^s \frac{1}{2}f''(X_s)g(X_s)^2\;\mathrm{d}s
\]
<p>e</p>
\[
g(X_s) = g(X_{t_0}) + \int_{t_0}^s g'(X_s)f(X_s)\;\mathrm{d}s + \int_{t_0}^s g'(X_s)g(X_s)\;\mathrm{d}W_s + \int_{t_0}^s \frac{1}{2}g''(X_s)g(X_s)^2\;\mathrm{d}s.
\]
<p>Substituindo essas expressões para \(f(X_s)\) e \(g(X_s)\) na equação integral para \(\{X_t\}_t\), obtemos</p>
\[
X_t = X_{t_0} + \int_{t_0}^t f(X_{t_0})\;\mathrm{d}s + \int_{t_0}^t g(X_{t_0})\;\mathrm{d}W_s + R_{t_0, t},
\]
<p>onde o resto \(R_{t_0, t}\) é dado por</p>
\[
\begin{align*}
R_{t_0, t} & = \int_{t_0}^{t} \left(\int_{t_0}^s \left(f'(X_\tau)f(X_\tau) + \frac{1}{2}f''(X_\tau)g(X_\tau)^2\right)\;\mathrm{d}\tau + \int_{t_0}^\tau f'(X_\tau)g(X_\tau)\;\mathrm{d}W_\tau\right)\;\mathrm{d}s \\
& \qquad + \int_{t_0}^{t} \left(\int_{t_0}^s \left(g'(X_\tau)f(X_\tau) + \frac{1}{2}g''(X_\tau)g(X_\tau)^2\right)\;\mathrm{d}\tau + \int_{t_0}^s g'(X_\tau)g(X_\tau)\;\mathrm{d}W_\tau\right)\;\mathrm{d}W_s.
\end{align*}
\]
<p>Expansões de ordem mais alta podem ser obtidas aplicando o mesmo procedimento aos integrandos no termo de resto \(R_{t_0, t}\). Mas observe que, como \(\mathrm{d}W_t \sim \sqrt{\mathrm{d}t}\), as diferentes integrais duplas presentes no termo de resto não têm a mesma ordem. Podemos dizer que, em uma aproximação com passo \(\Delta t = t - t_0\), </p>
\[
\begin{align*}
& \int_{t_0}^t \int_{t_0}^s F(X_\tau) \;\mathrm{d}\tau \;\mathrm{d}s \sim \Delta t^2. \\
& \int_{t_0}^t \int_{t_0}^s F(X_\tau) \;\mathrm{d}W_\tau \;\mathrm{d}s \sim \Delta t^{3/2} \\
& \int_{t_0}^t \int_{t_0}^s F(X_\tau) \;\mathrm{d}W_\tau \;\mathrm{d}W_s \sim \Delta t.
\end{align*}
\]
<p>Assim, podemos, de acordo com o objetivo, expandir \(F(X_\tau)\) apenas em alguns termos, de ordem mais baixa, começando pela integral estocástica dupla.</p>
<h2 id="expansão_nos_pontos_da_malha"><a href="#expansão_nos_pontos_da_malha" class="header-anchor">Expansão nos pontos da malha</a></h2>
<p>Em pontos \(t_j = jT/n\), \(j = 0, 1, \ldots, n\), podemos escrever</p>
\[
X_{t_j} = X_{t_{j-1}} + \int_{t_{j-1}}^{t_j} f(X_s)\;\mathrm{d}s + \int_{t_{j-1}}^{t_j} g(X_s)\;\mathrm{d}W_s.
\]
<p>Substituindo \(f(X_s)\) e \(g(X_s)\) de acordo com a fórmula de Itô a partir de um ponto \(t_{j-1}\) da malha, obtemos</p>
\[
X_{t_j} = X_{t_{j-1}} + \int_{t_{j-1}}^{t_j} f(X_{t_{j-1}})\;\mathrm{d}s + \int_{t_{j-1}}^{t_j} g(X_{t_{j-1}})\;\mathrm{d}W_s + R_j,
\]
<p>onde o resto \(R_j\) é dado por</p>
\[
\begin{align*}
R_j & = \int_{t_{j-1}}^{t_j} \left(\int_{t_{j-1}}^s \left(f'(X_\tau)f(X_\tau) + \frac{1}{2}f''(X_\tau)g(X_\tau)^2\right)\;\mathrm{d}\tau + \int_{t_{j-1}}^s f'(X_\tau)g(X_\tau)\;\mathrm{d}W_\tau\right)\;\mathrm{d}s \\
& \qquad + \int_{t_{j-1}}^{t_j} \left(\int_{t_{j-1}}^s \left(g'(X_\tau)f(X_\tau) + \frac{1}{2}g''(X_\tau)g(X_\tau)^2\right)\;\mathrm{d}\tau + \int_{t_{j-1}}^s g'(X_\tau)g(X_\tau)\;\mathrm{d}W_\tau\right)\;\mathrm{d}W_s.
\end{align*}
\]
<h2 id="revisitando_o_método_de_euler-maruyama"><a href="#revisitando_o_método_de_euler-maruyama" class="header-anchor">Revisitando o método de Euler-Maruyama</a></h2>
<p>Observe que a aproximação para o método de Euler-Maruyama é obtida ao descartarmos completamente o resto \(R_j\), ficando, apenas</p>
\[
X_{t_j} \approx X_{t_{j-1}} + \int_{t_{j-1}}^{t_j} f(X_{t_{j-1}})\;\mathrm{d}s + \int_{t_{j-1}}^{t_j} g(X_{t_{j-1}})\;\mathrm{d}W_s = X_{t_{j-1}} + f(X_{t_{j-1}})\Delta t + g(X_{t_{j-1}}) \Delta W_j,
\]
<p>onde \(\Delta W_j = W_{t_j} - W_{t_{j-1}}\).</p>
<p>Isso nos leva ao <strong>método de Euler-Maruyama</strong></p>
\[
X_j = X_{j-1} + f(X_{j-1}) \Delta t + g(X_{j-1})\Delta W_j, \qquad j = 1, \ldots, n,
\]
<p>com \(X_0\) dado.</p>
<h2 id="o_método_de_milstein"><a href="#o_método_de_milstein" class="header-anchor">O método de Milstein</a></h2>
<p>Para o método de Milstein, vamos reter o termo de ordem mais baixa do resto \(R_j\), que é o termo com a integral estocástica dupla:</p>
\[
\int_{t_{j-1}}^{t_j} \int_{t_{j-1}}^s g'(X_\tau)g(X_\tau)\;\mathrm{d}W_\tau\;\mathrm{d}W_s.
\]
<p>Considerando \(u(x) = g'(x)g(x)\) e aplicando a isometria de Itô a \(\{u(X_t)\}_{t \geq 0}\), obtemos</p>
\[
g'(X_\tau)g(X_\tau) = g'(X_{t_{j-1}})g(X_{t_{j-1}}) + \int_{t_{j-1}}^\tau \mathrm{d}u(X_\eta),
\]
<p>com</p>
\[
\begin{align*}
\mathrm{d}u(X_t) & = u'(X_t)\;\mathrm{d}X_t + \frac{1}{2}u''(X_t)g(X_t)^2\;\mathrm{d}t \\
& = (g''(X_t)g(X_t) + g'(X_t)^2)f(X_t)\;\mathrm{d}t \\
& \qquad + (g''(X_t)g(X_t) + g'(X_t)^2)g(X_t)\;\mathrm{d}W_t \\
& \qquad + \frac{1}{2}(g'''(X_t)g(X_t) + 3g''(X_t)g'(X_t) + g'(X_t)^3)g(X_t)^2\;\mathrm{d}t.
\end{align*}
\]
<p>Isso implica em</p>
\[
\int_{t_{j-1}}^{t_j} \int_{t_{j-1}}^s g'(X_\tau)g(X_\tau)\;\mathrm{d}W_\tau\;\mathrm{d}W_s = \int_{t_{j-1}}^{t_j} \int_{t_{j-1}}^s g'(X_{t_{j-1}})g(X_{t_{j-1}})\;\mathrm{d}W_\tau\;\mathrm{d}W_s + \int_{t_{j-1}}^{t_j} \int_{t_{j-1}}^s \int_{t_{j-1}}^\tau \;\mathrm{d}u(X_\eta)\;\mathrm{d}W_\tau\;\mathrm{d}W_s,
\]
<p>que nos leva à expansão</p>
\[
X_{t_j} = X_{t_{j-1}} + \int_{t_{j-1}}^{t_j} f(X_{t_{j-1}})\;\mathrm{d}s + \int_{t_{j-1}}^{t_j} g(X_{t_{j-1}})\;\mathrm{d}W_s + g'(X_{t_{j-1}})g(X_{t_{j-1}})\int_{t_{j-1}}^{t_j} \int_{t_{j-1}}^s \;\mathrm{d}W_\tau\;\mathrm{d}W_s + \tilde R_j,
\]
<p>com um resto \(\tilde R_j\) contendo a integral tripla no lugar da integral estocástica dupla. Descartando o resto \(\tilde R_j\), obtemos o aproximação utilizada no método de Milstein</p>
\[
\begin{align*}
X_{t_j} & \approx X_{t_{j-1}} + \int_{t_{j-1}}^{t_j} f(X_{j-1})\;\mathrm{d}s + \int_{t_{j-1}}^{t_j} g(X_{j-1})\;\mathrm{d}W_s + \int_{t_{j-1}}^{t_j} \int_{t_{j-1}}^s g'(X_{t_{j-1}})g(X_{t_{j-1}})\;\mathrm{d}W_\tau\;\mathrm{d}W_s \\
& = X_{t_{j-1}} + f(X_{j-1})\Delta t + g(X_{j-1}) (W_{t_j} - W_{t_{j-1}}) + g'(X_{t_{j-1}})g(X_{t_{j-1}})\int_{t_{j-1}}^{t_j} \int_{t_{j-1}}^s \;\mathrm{d}W_\tau\;\mathrm{d}W_s.
\end{align*}
\]
<p>Nesse caso em particula, a integral estocástica dupla pode ser calculada mais explicitamente. De fato, a integral interior é simplesmente</p>
\[
\int_{t_{j-1}}^s \;\mathrm{d}W_\tau = W_s - W_{t_{j-1}}.
\]
<p>Assim,</p>
\[
\int_{t_{j-1}}^{t_j} \int_{t_{j-1}}^s \;\mathrm{d}W_\tau\;\mathrm{d}W_s = \int_{t_{j-1}}^{t_j} (W_s - W_{t_{j-1}})\;\mathrm{d}W_s.
\]
<p>Podemos usar a propriedade de invariância por translação dos processos de Wiener, que diz que \(\{\tilde W_\tau\}_{\tau \geq 0}\) dado por \(\tilde W_\tau = W_{t_{j-1} + \tau} - W_{t_{j-1}}\) também é um processo de Wiener, para escrever</p>
\[
\int_{t_{j-1}}^{t_j} (W_s - W_{t_{j-1}})\;\mathrm{d}W_s = \int_{0}^{\Delta t} \tilde W_\tau\;\mathrm{d}\tilde W_\tau = \frac{\tilde W_{\Delta t}^2}{2} - \frac{\Delta t}{2} = \frac{(W_{t_j} - W_{t_{j-1}})^2}{2} - \frac{\Delta t}{2}.
\]
<p>Ou, mais diretamente,</p>
\[
\begin{align*}
\int_{t_{j-1}}^{t_j} \int_{t_{j-1}}^s \;\mathrm{d}W_\tau\;\mathrm{d}W_s & = \int_{t_{j-1}}^{t_j} (W_s - W_{t_{j-1}})\;\mathrm{d}W_s \\
& = \int_{t_{j-1}}^{t_j} W_s \;\mathrm{d}W_s - \int_{t_{j-1}}^{t_j} W_{t_{j-1}}\;\mathrm{d}W_s \\
& = \frac{1}{2}\left(W_{t_j}^2 - W_{t_{j-1}}^2 - t_j + t_{j-1} \right) - W_{t_{j-1}}\left(W_{t_j} - W_{t_{j-1}}\right) \\
& = \frac{1}{2}\left((W_{t_j} + W_{t_{j-1}})(W_{t_j} - W_{t_{j-1}}) - t_j + t_{j-1} \right) - W_{t_{j-1}}\left(W_{t_j} - W_{t_{j-1}}\right) \\
& = \frac{1}{2}\left((W_{t_j} + W_{t_{j-1}})(W_{t_j} - W_{t_{j-1}}) - 2W_{t_{j-1}}\left(W_{t_j} - W_{t_{j-1}}\right) \right) - \frac{\Delta t}{2} \\
& = \frac{1}{2}\left(W_{t_j} - W_{t_{j-1}}\right)^2 - \frac{\Delta t}{2}
\end{align*}
\]
<p>De um jeito ou de outro, podemos escrever</p>
\[
\int_{t_{j-1}}^{t_j} (W_s - W_{t_{j-1}})\;\mathrm{d}W_s = \frac{\Delta W_j^2}{2} - \frac{\Delta t}{2},
\]
<p>onde \(\Delta W_j = W_{t_j} - W_{t_{j-1}}\). Dessa forma, obtemos aproximação</p>
\[
X_{t_j} \approx X_{t_{j-1}} + f(X_{j-1})\Delta t + g(X_{j-1}) \Delta W_j + \frac{1}{2}g'(X_{t_{j-1}})g(X_{t_{j-1}})\left(\Delta W_j^2 - \Delta t\right),
\]
<p>Isso nos leva ao <strong>método de Milstein</strong></p>
\[
X_j = X_{j-1} + f(X_{j-1}) \Delta t + g(X_{j-1})\Delta W_j + \frac{1}{2}g'(X_{j-1})g(X_{j-1})\left(\Delta W_j^2 - \Delta t\right), \qquad j = 1, \ldots, n,
\]
<p>com \(X_0\) dado.</p>
<h2 id="ordem_de_convergência_do_método_de_milstein"><a href="#ordem_de_convergência_do_método_de_milstein" class="header-anchor">Ordem de convergência do método de Milstein</a></h2>
<p>Não faremos as estimativas aqui, mas, como dito acima, pode-se mostrar que o método de Milstein tem ordem forte \(1\) e ordem fraca \(1\), também.</p>

    <div class="navbar">
    <p id="nav">
<span id="nav-prev" style="float: left;">
<a class="menu-level-1" href="/notas_sde/pages/c09/heun">9.5. Método de Heun <kbd>←</kbd></a>
</span>
<span id="nav-next" style="float: right;">
    <a class="menu-level-1" href="/notas_sde/pages/c09/simulacoes_milstein"><kbd>→</kbd> 9.7. Simulações Milstein</a>
</span>
    </p>
</div>
</br></br>



<div class="page-foot">
    
        <div class="license">
            <a href=https://creativecommons.org/licenses/by-nc-nd/4.0/>(CC BY-NC-ND 4.0) Attribution-NonCommercial-NoDerivatives 4.0 International </a>
            Ricardo M. S. Rosa
        </div>
    

    Last modified: July 25, 2022. Built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a>, using the <a href="https://github.com/rmsrosa/booksjl-franklin-template">Book Template</a>.
</div><!-- CONTENT ENDS HERE -->

      </div> <!-- .books-content -->
    </div> <!-- .books-container -->

    
        <script src="/notas_sde/libs/katex/katex.min.js"></script>
        <script src="/notas_sde/libs/katex/auto-render.min.js"></script>
        <script>renderMathInElement(document.body)</script>
    

    

  </body>
</html>
